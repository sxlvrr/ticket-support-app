<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Créer un ticket</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
</head>
<body>
  <h1>➕ Créer un ticket</h1>
  <a href="index.html">⬅️ Retour à l'accueil</a>
  <div id="root"></div>

  <script type="text/babel">
    function App() {
      const [formData, setFormData] = React.useState({
        titre: '',
        description: '',
        priorité: 'Faible',
        id_employe: 1
      });
      const [message, setMessage] = React.useState('');

      const handleChange = (e) => {
        setFormData({ ...formData, [e.target.name]: e.target.value });
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        fetch('http://localhost:5000/tickets', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(formData)
        })
        .then(res => res.json())
        .then(data => {
          setMessage(data.message);
          setFormData({ titre: '', description: '', priorité: 'Faible', id_employe: 1 });
        })
        .catch(() => setMessage("Erreur ❌"));
      };

      return (
        <form onSubmit={handleSubmit}>
          <input name="titre" value={formData.titre} onChange={handleChange} placeholder="Titre" required /><br />
          <textarea name="description" value={formData.description} onChange={handleChange} placeholder="Description" required /><br />
          <select name="priorité" value={formData.priorité} onChange={handleChange}>
            <option>Faible</option>
            <option>Moyenne</option>
            <option>Élevée</option>
          </select><br />
          <button type="submit">Créer</button>
          {message && <p><strong>{message}</strong></p>}
        </form>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
