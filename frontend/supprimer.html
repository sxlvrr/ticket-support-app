<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Supprimer un ticket</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6.26.0/babel.min.js"></script>
</head>
<body>
  <h1>❌ Supprimer un ticket</h1>
  <a href="index.html">⬅️ Retour à l'accueil</a>
  <div id="root"></div>

  <script type="text/babel">
    function App() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get("id");
      const [message, setMessage] = React.useState('');
      const [confirm, setConfirm] = React.useState(false);

      const handleDelete = () => {
        fetch(`http://localhost:5000/tickets/${id}`, {
          method: 'DELETE'
        })
        .then(res => res.json())
        .then(data => setMessage(data.message))
        .catch(() => setMessage("Erreur ❌"));
      };

      return (
        <div>
          {message ? (
            <p><strong>{message}</strong></p>
          ) : (
            <>
              {!confirm ? (
                <>
                  <p>Tu veux vraiment supprimer ce ticket ?</p>
                  <button onClick={() => setConfirm(true)}>Oui, supprimer</button>
                </>
              ) : (
                <button onClick={handleDelete}>Confirmer la suppression 🗑️</button>
              )}
            </>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
